<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>WMP Secure System</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0f1115;
    color: #fff;
}

/* LOGIN */
#login {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
}

.login-box {
    background: #151820;
    padding: 30px;
    border-radius: 10px;
    width: 300px;
}

input, textarea {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    background: #1e2230;
    border: none;
    border-radius: 6px;
    color: #fff;
}

button {
    padding: 10px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
}

.save { background: #3b82f6; color: #fff; }
.delete { background: #ef4444; color: #fff; }

#app { display: none; height: 100vh; }

/* LAYOUT */
.container {
    display: flex;
    height: 100%;
}

.sidebar {
    width: 30%;
    background: #151820;
    padding: 15px;
    overflow-y: auto;
}

.main {
    width: 70%;
    padding: 20px;
}

.person {
    background: #1e2230;
    padding: 14px;
    border-radius: 8px;
    margin-bottom: 10px;
    cursor: pointer;
}

.badge {
    padding: 3px 6px;
    border-radius: 4px;
    font-size: 12px;
    margin-right: 4px;
}

.red { background: #ef4444; }
.yellow { background: #eab308; }
.green { background: #22c55e; }
.blue { background: #3b82f6; }

.logs {
    background: #151820;
    padding: 10px;
    border-radius: 8px;
    margin-top: 15px;
    font-size: 13px;
    max-height: 200px;
    overflow-y: auto;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
    <div class="login-box">
        <h3>WMP Login</h3>
        <input id="user" placeholder="Detective">
        <input id="pass" type="password" placeholder="Passwort">
        <button class="save" onclick="login()">Login</button>
    </div>
</div>

<!-- APP -->
<div id="app">
<div class="container">

<div class="sidebar">
    <h3>Personen</h3>
    <input id="search" placeholder="üîç Suche..." oninput="renderList()">
    <button class="save" onclick="addPerson()">+ Neue Person</button>
    <div id="personList"></div>
</div>

<div class="main">
    <h3>Details</h3>

    <input id="name" placeholder="Name">
    <input id="age" placeholder="Alter">
    <input id="height" placeholder="Gr√∂√üe">
    <input id="eyes" placeholder="Augenfarbe">

    <textarea id="info" placeholder="Weitere Infos"></textarea>
    <textarea id="crimes" placeholder="Delikte"></textarea>

    <label><input type="checkbox" id="warrant"> Haftbefehl</label>
    <label><input type="checkbox" id="watch"> Unter Beobachtung</label>
    <label><input type="checkbox" id="clean"> Clean</label>
    <label><input type="checkbox" id="prison"> In Haft</label>

    <br><br>
    <button class="save" onclick="savePerson()">Speichern</button>
    <button class="delete" onclick="deletePerson()">L√∂schen</button>

    <div class="logs" id="logs"></div>
</div>

</div>
</div>

<script>
/* AUTH */
function login() {
    if (user.value === "Marlon P." && pass.value === "DirectorWMP") {
        localStorage.setItem("wmp_auth", "true");
        location.reload();
    } else alert("Zugriff verweigert");
}

if (localStorage.getItem("wmp_auth") === "true") {
    login.style.display = "none";
    app.style.display = "block";
}

/* DATA */
let persons = JSON.parse(localStorage.getItem("wmp_persons")) || [];
let logs = JSON.parse(localStorage.getItem("wmp_logs")) || [];
let currentIndex = null;

function log(action) {
    logs.unshift(new Date().toLocaleString() + " ‚Äì " + action);
    localStorage.setItem("wmp_logs", JSON.stringify(logs));
    renderLogs();
}

function renderLogs() {
    logsDiv.innerHTML = logs.map(l => "‚Ä¢ " + l).join("<br>");
}

/* LIST */
function renderList() {
    personList.innerHTML = "";
    const q = search.value.toLowerCase();

    persons.forEach((p, i) => {
        const name = p.name?.trim() || "Unbekannt";
        if (!name.toLowerCase().includes(q)) return;

        const div = document.createElement("div");
        div.className = "person";
        div.innerHTML = `
            <b>${name}</b><br>
            ${p.warrant ? '<span class="badge red">Haftbefehl</span>' : ''}
            ${p.watch ? '<span class="badge yellow">Beobachtung</span>' : ''}
            ${p.clean ? '<span class="badge green">Clean</span>' : ''}
            ${p.prison ? '<span class="badge blue">In Haft</span>' : ''}
        `;
        div.onclick = () => loadPerson(i);
        personList.appendChild(div);
    });
}

/* CRUD */
function addPerson() {
    persons.push({});
    currentIndex = persons.length - 1;
    save();
    renderList();
}

function loadPerson(i) {
    currentIndex = i;
    const p = persons[i];
    name.value = p.name || "";
    age.value = p.age || "";
    height.value = p.height || "";
    eyes.value = p.eyes || "";
    info.value = p.info || "";
    crimes.value = p.crimes || "";
    warrant.checked = p.warrant || false;
    watch.checked = p.watch || false;
    clean.checked = p.clean || false;
    prison.checked = p.prison || false;
}

function savePerson() {
    if (currentIndex === null) return;
    persons[currentIndex] = {
        name: name.value,
        age: age.value,
        height: height.value,
        eyes: eyes.value,
        info: info.value,
        crimes: crimes.value,
        warrant: warrant.checked,
        watch: watch.checked,
        clean: clean.checked,
        prison: prison.checked
    };
    log("Person gespeichert: " + (name.value || "Unbekannt"));
    save();
    renderList();
}

function deletePerson() {
    const code = prompt("Delete-Code:");
    if (code !== "2025") return alert("Falscher Code");
    log("Person gel√∂scht");
    persons.splice(currentIndex, 1);
    currentIndex = null;
    save();
    renderList();
}

function save() {
    localStorage.setItem("wmp_persons", JSON.stringify(persons));
}

renderList();
renderLogs();
</script>

</body>
</html>
